<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2563eb">
    <link rel="manifest" href="manifest.json">
    <title>æ—¥æœ¬é…’ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        h1 {
            color: #2563eb;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .stats {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .form-container, .list-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .photo-upload-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .photo-upload-box {
            flex: 1;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .photo-upload-box:hover {
            border-color: #2563eb;
        }
        
        .photo-upload-box img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .photo-upload-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }
        
        .photo-upload-text {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }
        
        .photo-preview {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .photo-preview img {
            width: calc(50% - 5px);
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        input[type="file"] {
            display: none;
        }
        
        .stars {
            display: flex;
            gap: 5px;
            cursor: pointer;
        }
        
        .star {
            font-size: 24px;
            color: #ddd;
            transition: color 0.2s;
        }
        
        .star.active {
            color: #fbbf24;
        }
        
        button {
            width: 100%;
            padding: 12px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        button:hover {
            background: #1d4ed8;
        }
        
        .cancel-btn {
            background: #6b7280;
            margin-top: 5px;
        }
        
        .cancel-btn:hover {
            background: #4b5563;
        }
        
        .sake-item {
            background: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #2563eb;
        }
        
        .sake-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .sake-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .sake-memo {
            font-size: 14px;
            color: #444;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e5e7eb;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .action-buttons {
            float: right;
            display: flex;
            gap: 5px;
        }
        
        .edit-btn, .delete-btn {
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .edit-btn {
            background: #059669;
        }
        
        .edit-btn:hover {
            background: #047857;
        }
        
        .delete-btn {
            background: #dc2626;
        }
        
        .delete-btn:hover {
            background: #b91c1c;
        }
        
        h2 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 10px;
            color: #2563eb;
        }
        
        .edit-mode {
            background: #fef3c7;
            border: 2px solid #f59e0b;
        }
    </style>
</head>
<body>
    <h1>ğŸ¶ æ—¥æœ¬é…’ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼</h1>
    
    <div class="stats">
        <div class="stat-item">
            <div class="stat-number" id="totalCount">0</div>
            <div class="stat-label">ç·æ•°</div>
        </div>
        <div class="stat-item">
            <div class="stat-number" id="prefCount">0</div>
            <div class="stat-label">éƒ½é“åºœçœŒ</div>
        </div>
    </div>
    
    <div class="form-container" id="formContainer">
        <h2 id="formTitle">æ–°è¦ç™»éŒ²</h2>
        
        <div class="section-title">å†™çœŸ</div>
        
        <div class="photo-upload-container">
            <div class="photo-upload-box" onclick="document.getElementById('frontPhoto').click()">
                <img id="frontPreview" style="display: none;">
                <div id="frontPlaceholder">
                    <div class="photo-upload-label">è¡¨ãƒ©ãƒ™ãƒ«</div>
                    <div class="photo-upload-text">ğŸ“· ã‚¿ãƒƒãƒ—ã—ã¦è¿½åŠ </div>
                </div>
                <input type="file" id="frontPhoto" accept="image/*" onchange="handlePhotoUpload('front')">
            </div>
            
            <div class="photo-upload-box" onclick="document.getElementById('backPhoto').click()">
                <img id="backPreview" style="display: none;">
                <div id="backPlaceholder">
                    <div class="photo-upload-label">è£ãƒ©ãƒ™ãƒ«</div>
                    <div class="photo-upload-text">ğŸ“· ã‚¿ãƒƒãƒ—ã—ã¦è¿½åŠ </div>
                </div>
                <input type="file" id="backPhoto" accept="image/*" onchange="handlePhotoUpload('back')">
            </div>
        </div>
        
        <div class="section-title">åŸºæœ¬æƒ…å ±</div>
        
        <div class="form-group">
            <label>éŠ˜æŸ„å *</label>
            <input type="text" id="name" required>
        </div>
        
        <div class="form-group">
            <label>é…’è”µå *</label>
            <input type="text" id="brewery" required>
        </div>
        
        <div class="form-group">
            <label>éƒ½é“åºœçœŒ *</label>
            <select id="prefecture" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="åŒ—æµ·é“">åŒ—æµ·é“</option>
                <option value="é’æ£®çœŒ">é’æ£®çœŒ</option>
                <option value="å²©æ‰‹çœŒ">å²©æ‰‹çœŒ</option>
                <option value="å®®åŸçœŒ">å®®åŸçœŒ</option>
                <option value="ç§‹ç”°çœŒ">ç§‹ç”°çœŒ</option>
                <option value="å±±å½¢çœŒ">å±±å½¢çœŒ</option>
                <option value="ç¦å³¶çœŒ">ç¦å³¶çœŒ</option>
                <option value="èŒ¨åŸçœŒ">èŒ¨åŸçœŒ</option>
                <option value="æ ƒæœ¨çœŒ">æ ƒæœ¨çœŒ</option>
                <option value="ç¾¤é¦¬çœŒ">ç¾¤é¦¬çœŒ</option>
                <option value="åŸ¼ç‰çœŒ">åŸ¼ç‰çœŒ</option>
                <option value="åƒè‘‰çœŒ">åƒè‘‰çœŒ</option>
                <option value="æ±äº¬éƒ½">æ±äº¬éƒ½</option>
                <option value="ç¥å¥ˆå·çœŒ">ç¥å¥ˆå·çœŒ</option>
                <option value="æ–°æ½ŸçœŒ">æ–°æ½ŸçœŒ</option>
                <option value="å¯Œå±±çœŒ">å¯Œå±±çœŒ</option>
                <option value="çŸ³å·çœŒ">çŸ³å·çœŒ</option>
                <option value="ç¦äº•çœŒ">ç¦äº•çœŒ</option>
                <option value="å±±æ¢¨çœŒ">å±±æ¢¨çœŒ</option>
                <option value="é•·é‡çœŒ">é•·é‡çœŒ</option>
                <option value="å²é˜œçœŒ">å²é˜œçœŒ</option>
                <option value="é™å²¡çœŒ">é™å²¡çœŒ</option>
                <option value="æ„›çŸ¥çœŒ">æ„›çŸ¥çœŒ</option>
                <option value="ä¸‰é‡çœŒ">ä¸‰é‡çœŒ</option>
                <option value="æ»‹è³€çœŒ">æ»‹è³€çœŒ</option>
                <option value="äº¬éƒ½åºœ">äº¬éƒ½åºœ</option>
                <option value="å¤§é˜ªåºœ">å¤§é˜ªåºœ</option>
                <option value="å…µåº«çœŒ">å…µåº«çœŒ</option>
                <option value="å¥ˆè‰¯çœŒ">å¥ˆè‰¯çœŒ</option>
                <option value="å’Œæ­Œå±±çœŒ">å’Œæ­Œå±±çœŒ</option>
                <option value="é³¥å–çœŒ">é³¥å–çœŒ</option>
                <option value="å³¶æ ¹çœŒ">å³¶æ ¹çœŒ</option>
                <option value="å²¡å±±çœŒ">å²¡å±±çœŒ</option>
                <option value="åºƒå³¶çœŒ">åºƒå³¶çœŒ</option>
                <option value="å±±å£çœŒ">å±±å£çœŒ</option>
                <option value="å¾³å³¶çœŒ">å¾³å³¶çœŒ</option>
                <option value="é¦™å·çœŒ">é¦™å·çœŒ</option>
                <option value="æ„›åª›çœŒ">æ„›åª›çœŒ</option>
                <option value="é«˜çŸ¥çœŒ">é«˜çŸ¥çœŒ</option>
                <option value="ç¦å²¡çœŒ">ç¦å²¡çœŒ</option>
                <option value="ä½è³€çœŒ">ä½è³€çœŒ</option>
                <option value="é•·å´çœŒ">é•·å´çœŒ</option>
                <option value="ç†Šæœ¬çœŒ">ç†Šæœ¬çœŒ</option>
                <option value="å¤§åˆ†çœŒ">å¤§åˆ†çœŒ</option>
                <option value="å®®å´çœŒ">å®®å´çœŒ</option>
                <option value="é¹¿å…å³¶çœŒ">é¹¿å…å³¶çœŒ</option>
                <option value="æ²–ç¸„çœŒ">æ²–ç¸„çœŒ</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>é£²ã‚“ã æ—¥</label>
            <input type="date" id="date">
        </div>
        
        <div class="section-title">æ—¥æœ¬é…’æƒ…å ±</div>
        
        <div class="form-group">
            <label>ç‰¹å®šåç§°</label>
            <select id="classification">
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="æ™®é€šé…’">æ™®é€šé…’</option>
                <option value="æœ¬é†¸é€ é…’">æœ¬é†¸é€ é…’</option>
                <option value="ç‰¹åˆ¥æœ¬é†¸é€ é…’">ç‰¹åˆ¥æœ¬é†¸é€ é…’</option>
                <option value="ç´”ç±³é…’">ç´”ç±³é…’</option>
                <option value="ç‰¹åˆ¥ç´”ç±³é…’">ç‰¹åˆ¥ç´”ç±³é…’</option>
                <option value="åŸé†¸é…’">åŸé†¸é…’</option>
                <option value="ç´”ç±³åŸé†¸é…’">ç´”ç±³åŸé†¸é…’</option>
                <option value="å¤§åŸé†¸é…’">å¤§åŸé†¸é…’</option>
                <option value="ç´”ç±³å¤§åŸé†¸é…’">ç´”ç±³å¤§åŸé†¸é…’</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>æ—¥æœ¬é…’åº¦</label>
            <input type="text" id="nihonshuDo" placeholder="ä¾‹: +5">
        </div>
        
        <div class="form-group">
            <label>ç²¾ç±³æ­©åˆ</label>
            <input type="text" id="seimaibuai" placeholder="ä¾‹: 50%">
        </div>
        
        <div class="form-group">
            <label>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«åº¦æ•°</label>
            <input type="text" id="alcohol" placeholder="ä¾‹: 15åº¦">
        </div>
        
        <div class="form-group">
            <label>ç«å…¥ã‚Œ</label>
            <select id="hiire">
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="ç”Ÿé…’">ç”Ÿé…’</option>
                <option value="ç«å…¥ã‚Œ">ç«å…¥ã‚Œ</option>
                <option value="ä¸æ˜">ä¸æ˜</option>
            </select>
        </div>
        
        <div class="section-title">å€‹äººè¨˜éŒ²</div>
        
        <div class="form-group">
            <label>å‘³ã®è©•ä¾¡</label>
            <div class="stars" id="tasteRating">
                <span class="star" data-value="1">â˜…</span>
                <span class="star" data-value="2">â˜…</span>
                <span class="star" data-value="3">â˜…</span>
                <span class="star" data-value="4">â˜…</span>
                <span class="star" data-value="5">â˜…</span>
            </div>
        </div>
        
        <div class="form-group">
            <label>ãŠã™ã™ã‚åº¦</label>
            <div class="stars" id="recommendRating">
                <span class="star" data-value="1">â˜…</span>
                <span class="star" data-value="2">â˜…</span>
                <span class="star" data-value="3">â˜…</span>
                <span class="star" data-value="4">â˜…</span>
                <span class="star" data-value="5">â˜…</span>
            </div>
        </div>
        
        <div class="form-group">
            <label>å‘³ã‚ã„ãƒ¡ãƒ¢</label>
            <textarea id="memo" placeholder="é¦™ã‚Šã€å‘³ã‚ã„ã®å°è±¡ã‚’è‡ªç”±ã«è¨˜å…¥..."></textarea>
        </div>
        
        <div class="form-group">
            <label>é£²ã‚“ã å ´æ‰€</label>
            <input type="text" id="place" placeholder="ä¾‹: è‡ªå®…ã€å±…é…’å±‹â—¯â—¯">
        </div>
        
        <button onclick="saveSake()" id="saveBtn">ç™»éŒ²ã™ã‚‹</button>
        <button onclick="cancelEdit()" id="cancelBtn" class="cancel-btn" style="display: none;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>
    
    <div class="list-container">
        <h2>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§</h2>
        <div id="sakeList"></div>
    </div>

    <script>
        // Service Workerç™»éŒ²ï¼ˆPWAåŒ–ï¼‰
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js');
        }

        let collection = [];
        let tasteRatingValue = 0;
        let recommendRatingValue = 0;
        let editingId = null;
        let frontPhotoData = null;
        let backPhotoData = null;
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ
        window.onload = function() {
            const saved = localStorage.getItem('sakeCollection');
            if (saved) {
                collection = JSON.parse(saved);
                displayCollection();
            }
            updateStats();
        };
        
        // å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        function handlePhotoUpload(type) {
            const input = document.getElementById(type + 'Photo');
            const preview = document.getElementById(type + 'Preview');
            const placeholder = document.getElementById(type + 'Placeholder');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    placeholder.style.display = 'none';
                    
                    if (type === 'front') {
                        frontPhotoData = e.target.result;
                    } else {
                        backPhotoData = e.target.result;
                    }
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
        
        // æ˜Ÿè©•ä¾¡ã®è¨­å®š
        document.querySelectorAll('.stars').forEach(container => {
            const stars = container.querySelectorAll('.star');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.dataset.value);
                    if (container.id === 'tasteRating') {
                        tasteRatingValue = value;
                    } else {
                        recommendRatingValue = value;
                    }
                    updateStars(container, value);
                });
            });
        });
        
        function updateStars(container, value) {
            const stars = container.querySelectorAll('.star');
            stars.forEach((star, index) => {
                if (index < value) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }
        
        function saveSake() {
            const name = document.getElementById('name').value;
            const brewery = document.getElementById('brewery').value;
            const prefecture = document.getElementById('prefecture').value;
            
            if (!name || !brewery || !prefecture) {
                alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            const sake = {
                id: editingId || Date.now(),
                name: name,
                brewery: brewery,
                prefecture: prefecture,
                date: document.getElementById('date').value,
                classification: document.getElementById('classification').value,
                nihonshuDo: document.getElementById('nihonshuDo').value,
                seimaibuai: document.getElementById('seimaibuai').value,
                alcohol: document.getElementById('alcohol').value,
                hiire: document.getElementById('hiire').value,
                tasteRating: tasteRatingValue,
                recommendRating: recommendRatingValue,
                memo: document.getElementById('memo').value,
                place: document.getElementById('place').value,
                frontPhoto: frontPhotoData,
                backPhoto: backPhotoData
            };
            
            if (editingId) {
                // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼šæ—¢å­˜ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ›´æ–°
                collection = collection.map(item => item.id === editingId ? sake : item);
                alert('æ›´æ–°ã—ã¾ã—ãŸï¼');
            } else {
                // æ–°è¦ç™»éŒ²ãƒ¢ãƒ¼ãƒ‰
                collection.push(sake);
                alert('ç™»éŒ²ã—ã¾ã—ãŸï¼');
            }
            
            localStorage.setItem('sakeCollection', JSON.stringify(collection));
            resetForm();
            displayCollection();
            updateStats();
        }
        
        function editSake(id) {
            const sake = collection.find(item => item.id === id);
            if (!sake) return;
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’ã‚»ãƒƒãƒˆ
            document.getElementById('name').value = sake.name;
            document.getElementById('brewery').value = sake.brewery;
            document.getElementById('prefecture').value = sake.prefecture;
            document.getElementById('date').value = sake.date || '';
            document.getElementById('classification').value = sake.classification || '';
            document.getElementById('nihonshuDo').value = sake.nihonshuDo || '';
            document.getElementById('seimaibuai').value = sake.seimaibuai || '';
            document.getElementById('alcohol').value = sake.alcohol || '';
            document.getElementById('hiire').value = sake.hiire || '';
            document.getElementById('memo').value = sake.memo || '';
            document.getElementById('place').value = sake.place || '';
            
            // å†™çœŸã‚’ã‚»ãƒƒãƒˆ
            frontPhotoData = sake.frontPhoto || null;
            backPhotoData = sake.backPhoto || null;
            
            if (frontPhotoData) {
                document.getElementById('frontPreview').src = frontPhotoData;
                document.getElementById('frontPreview').style.display = 'block';
                document.getElementById('frontPlaceholder').style.display = 'none';
            }
            
            if (backPhotoData) {
                document.getElementById('backPreview').src = backPhotoData;
                document.getElementById('backPreview').style.display = 'block';
                document.getElementById('backPlaceholder').style.display = 'none';
            }
            
            // æ˜Ÿè©•ä¾¡ã‚’ã‚»ãƒƒãƒˆ
            tasteRatingValue = sake.tasteRating || 0;
            recommendRatingValue = sake.recommendRating || 0;
            updateStars(document.getElementById('tasteRating'), tasteRatingValue);
            updateStars(document.getElementById('recommendRating'), recommendRatingValue);
            
            // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ
            editingId = id;
            document.getElementById('formTitle').textContent = 'ç·¨é›†';
            document.getElementById('saveBtn').textContent = 'æ›´æ–°ã™ã‚‹';
            document.getElementById('cancelBtn').style.display = 'block';
            document.getElementById('formContainer').classList.add('edit-mode');
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            document.getElementById('formContainer').scrollIntoView({ behavior: 'smooth' });
        }
        
        function cancelEdit() {
            resetForm();
        }
        
        function resetForm() {
            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢
            document.getElementById('name').value = '';
            document.getElementById('brewery').value = '';
            document.getElementById('prefecture').value = '';
            document.getElementById('date').value = '';
            document.getElementById('classification').value = '';
            document.getElementById('nihonshuDo').value = '';
            document.getElementById('seimaibuai').value = '';
            document.getElementById('alcohol').value = '';
            document.getElementById('hiire').value = '';
            document.getElementById('memo').value = '';
            document.getElementById('place').value = '';
            tasteRatingValue = 0;
            recommendRatingValue = 0;
            document.querySelectorAll('.star').forEach(s => s.classList.remove('active'));
            
            // å†™çœŸã‚’ã‚¯ãƒªã‚¢
            frontPhotoData = null;
            backPhotoData = null;
            document.getElementById('frontPreview').style.display = 'none';
            document.getElementById('frontPlaceholder').style.display = 'block';
            document.getElementById('backPreview').style.display = 'none';
            document.getElementById('backPlaceholder').style.display = 'block';
            document.getElementById('frontPhoto').value = '';
            document.getElementById('backPhoto').value = '';
            
            // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã‚’è§£é™¤
            editingId = null;
            document.getElementById('formTitle').textContent = 'æ–°è¦ç™»éŒ²';
            document.getElementById('saveBtn').textContent = 'ç™»éŒ²ã™ã‚‹';
            document.getElementById('cancelBtn').style.display = 'none';
            document.getElementById('formContainer').classList.remove('edit-mode');
        }
        
        function deleteSake(id) {
            if (confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                collection = collection.filter(sake => sake.id !== id);
                localStorage.setItem('sakeCollection', JSON.stringify(collection));
                displayCollection();
                updateStats();
            }
        }
        
        function displayCollection() {
            const listDiv = document.getElementById('sakeList');
            
            if (collection.length === 0) {
                listDiv.innerHTML = '<p style="text-align:center;color:#999;">ã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>';
                return;
            }
            
            listDiv.innerHTML = collection.map(sake => {
                let photoHtml = '';
                if (sake.frontPhoto || sake.backPhoto) {
                    photoHtml = '<div class="photo-preview">';
                    if (sake.frontPhoto) {
                        photoHtml += `<img src="${sake.frontPhoto}" alt="è¡¨ãƒ©ãƒ™ãƒ«">`;
                    }
                    if (sake.backPhoto) {
                        photoHtml += `<img src="${sake.backPhoto}" alt="è£ãƒ©ãƒ™ãƒ«">`;
                    }
                    photoHtml += '</div>';
                }
                
                return `
                    <div class="sake-item">
                        <div class="action-buttons">
                            <button class="edit-btn" onclick="editSake(${sake.id})">ç·¨é›†</button>
                            <button class="delete-btn" onclick="deleteSake(${sake.id})">å‰Šé™¤</button>
                        </div>
                        ${photoHtml}
                        <div class="sake-name">${sake.name}</div>
                        <div class="sake-info">
                            ${sake.brewery} (${sake.prefecture})
                            ${sake.classification ? '<span class="badge">' + sake.classification + '</span>' : ''}
                        </div>
                        ${sake.date ? '<div class="sake-info">ğŸ“… ' + sake.date + '</div>' : ''}
                        ${sake.nihonshuDo ? '<div class="sake-info">æ—¥æœ¬é…’åº¦: ' + sake.nihonshuDo + '</div>' : ''}
                        ${sake.seimaibuai ? '<div class="sake-info">ç²¾ç±³æ­©åˆ: ' + sake.seimaibuai + '</div>' : ''}
                        ${sake.alcohol ? '<div class="sake-info">ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«åº¦æ•°: ' + sake.alcohol + '</div>' : ''}
                        ${sake.hiire ? '<div class="sake-info">ç«å…¥ã‚Œ: ' + sake.hiire + '</div>' : ''}
                        ${sake.place ? '<div class="sake-info">ğŸ“ ' + sake.place + '</div>' : ''}
                        <div class="sake-info">
                            å‘³ã®è©•ä¾¡: ${'â˜…'.repeat(sake.tasteRating)}${'â˜†'.repeat(5-sake.tasteRating)}
                            ãŠã™ã™ã‚åº¦: ${'â˜…'.repeat(sake.recommendRating)}${'â˜†'.repeat(5-sake.recommendRating)}
                        </div>
                        ${sake.memo ? '<div class="sake-memo">' + sake.memo + '</div>' : ''}
                    </div>
                `;
            }).join('');
        }
        
        function updateStats() {
            document.getElementById('totalCount').textContent = collection.length;
            const uniquePrefectures = new Set(collection.map(s => s.prefecture));
            document.getElementById('prefCount').textContent = uniquePrefectures.size;
        }
    </script>
</body>
</html>
